#!/bin/sh

# Remove static libraries after linking to avoid R CMD check warnings about
# symbols in intermediate build artifacts (abort, exit, etc from Rust stdlib).
# The final shared library already contains everything needed.
# Note: We preserve libgcc_mock/*.a (needed for Rtools) and .o files (needed for incremental builds).

TARGET_DIR="${1:-src/rust/target}"

if [ -d "$TARGET_DIR" ]; then
    find "$TARGET_DIR" -name '*.rlib' -delete 2>/dev/null || true
    find "$TARGET_DIR" -name '*.a' ! -path '*/libgcc_mock/*' -delete 2>/dev/null || true
fi

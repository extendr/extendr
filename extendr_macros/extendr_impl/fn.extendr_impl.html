<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="Make inherent implementations available to R"><title>extendr_impl in extendr_macros::extendr_impl - Rust</title><script>if(window.location.protocol!=="file:")document.head.insertAdjacentHTML("beforeend","SourceSerif4-Regular-46f98efaafac5295.ttf.woff2,FiraSans-Regular-018c141bf0843ffd.woff2,FiraSans-Medium-8f9a781e4970d388.woff2,SourceCodePro-Regular-562dcc5011b6de7d.ttf.woff2,SourceCodePro-Semibold-d899c5a5c4aeb14a.ttf.woff2".split(",").map(f=>`<link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/${f}">`).join(""))</script><link rel="stylesheet" href="../../static.files/normalize-76eba96aa4d2e634.css"><link rel="stylesheet" href="../../static.files/rustdoc-fecee23daa4e8a6d.css"><meta name="rustdoc-vars" data-root-path="../../" data-static-root-path="../../static.files/" data-current-crate="extendr_macros" data-themes="" data-resource-suffix="" data-rustdoc-version="1.83.0-nightly (bd53aa3bf 2024-09-02)" data-channel="nightly" data-search-js="search-a99f1315e7cc5121.js" data-settings-js="settings-4313503d2e1961c2.js" ><script src="../../static.files/storage-118b08c4c78b968e.js"></script><script defer src="sidebar-items.js"></script><script defer src="../../static.files/main-921df33f47b8780c.js"></script><noscript><link rel="stylesheet" href="../../static.files/noscript-3b12f09e550e0385.css"></noscript><link rel="alternate icon" type="image/png" href="../../static.files/favicon-32x32-422f7d1d52889060.png"><link rel="icon" type="image/svg+xml" href="../../static.files/favicon-2c020d218678b618.svg"></head><body class="rustdoc fn"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle" title="show sidebar"></button></nav><nav class="sidebar"><div class="sidebar-crate"><h2><a href="../../extendr_macros/index.html">extendr_<wbr>macros</a><span class="version">0.7.0</span></h2></div><div class="sidebar-elems"><h2><a href="index.html">In extendr_<wbr>macros::<wbr>extendr_<wbr>impl</a></h2></div></nav><div class="sidebar-resizer"></div><main><div class="width-limiter"><rustdoc-search></rustdoc-search><section id="main-content" class="content"><div class="main-heading"><h1>Function <a href="../index.html">extendr_macros</a>::<wbr><a href="index.html">extendr_impl</a>::<wbr><a class="fn" href="#">extendr_impl</a><button id="copy-path" title="Copy item path to clipboard">Copy item path</button></h1><span class="out-of-band"><a class="src" href="../../src/extendr_macros/extendr_impl.rs.html#97-260">source</a> Â· <button id="toggle-all-docs" title="collapse all docs">[<span>&#x2212;</span>]</button></span></div><pre class="rust item-decl"><code>pub(crate) fn extendr_impl(
    item_impl: <a class="struct" href="https://docs.rs/syn/2.0.77/syn/item/struct.ItemImpl.html" title="struct syn::item::ItemImpl">ItemImpl</a>,
    opts: &amp;<a class="struct" href="../extendr_options/struct.ExtendrOptions.html" title="struct extendr_macros::extendr_options::ExtendrOptions">ExtendrOptions</a>,
) -&gt; <a class="type" href="https://docs.rs/syn/2.0.77/syn/error/type.Result.html" title="type syn::error::Result">Result</a>&lt;<a class="struct" href="https://doc.rust-lang.org/nightly/proc_macro/struct.TokenStream.html" title="struct proc_macro::TokenStream">TokenStream</a>&gt;</code></pre><details class="toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>Make inherent implementations available to R</p>
<p>The <code>extendr_impl</code> function is used to make inherent implementations
available to R as an environment. By adding the <a href="../attr.extendr.html" title="attr extendr_macros::extendr"><code>extendr</code></a> attribute
macro to an <code>impl</code> block (supported with <code>enum</code>s and <code>struct</code>s), the
methods in the impl block are made available as functions in an
environment.</p>
<p>On the R side, an environment with the same name of the inherent
implementation is created. The environment has functions within it
that correspond to each method in the impl block. Note that in order
for an impl block to be compatible with extendr (and thus R), its return
type must be able to be returned to R. For example, any struct that might
be returned must <em>also</em> have an <code>#[extendr]</code> annotated impl block.</p>
<p>Example:</p>
<div class="example-wrap"><pre class="language-dont_run"><code>use extendr_api::prelude::*;

// a struct that will be used internal the People struct
#[derive(Clone, Debug, IntoDataFrameRow)]
struct Person {
    name: String,
    age: i32,
}

// This will collect people in the struct
#[extendr]
#[derive(Clone, Debug)]
struct People(Vec&lt;Person&gt;);

#[extendr]
/// @export
impl People {
    // instantiate a new struct with an empty vector
    fn new() -&gt; Self {
        let vec: Vec&lt;Person&gt; = Vec::new();
        Self(vec)
    }

    // add a person to the internal vector
    fn add_person(&amp;mut self, name: &amp;str, age: i32) -&gt; &amp;mut Self {
        let person = Person {
            name: String::from(name),
            age: age,
        };

        self.0.push(person);

        // return self
        self
    }
     
    // Convert the struct into a data.frame
    fn into_df(&amp;self) -&gt; Robj {
        let df = self.0.clone().into_dataframe();

        match df {
            Ok(df) =&gt; df.as_robj().clone(),
            Err(_) =&gt; data_frame!(),
        }
    }

    // add another `People` struct to self
    fn add_people(&amp;mut self, others: &amp;People) -&gt; &amp;mut Self {
        self.0.extend(others.0.clone().into_iter());
        self
    }

    // create a function to print the self which can be called
    // from an R print method
    fn print_self(&amp;self) -&gt; String {
        format!(&quot;{:?}&quot;, self.0)
    }
}

// Macro to generate exports.
// This ensures exported functions are registered with R.
// See corresponding C code in `entrypoint.c`.
extendr_module! {
    mod testself;
    impl People;
}
</code></pre></div></div></details></section></div></main></body></html>